import requests

def scan_file(file_path, api_key):
    url = 'https://www.virustotal.com/vtapi/v2/file/report'
    params = {'apikey': api_key, 'resource': file_path}
    response = requests.get(url, params=params)
    json_response = response.json()
    if json_response['response_code'] == 1:
        positives = json_response['positives']
        total = json_response['total']
        if positives > 0:
            print(f"The file is malicious. Detected by {positives}/{total} antivirus engines.")
        else:
            print("The file is clean. It is not detected by any antivirus engines.")
    else:
        print("File scan failed. The file may not have been scanned yet or does not exist in VirusTotal.")

# Example usage
file_to_scan = '/Users/jagadeeshchowdary/Desktop/desktop/desktop/payload.exe'  # Replace with the path to your file
api_key = 'faa002b7e567af03925f6bdc06bd342cc660f2eb6d8e58389588b5a5aa202a35'  # Replace with your VirusTotal API key

scan_file(file_to_scan, api_key)

import requests

def check_file(file_path, api_key):
    url = 'https://www.virustotal.com/vtapi/v2/file/scan'
    params = {'apikey': api_key}
    files = {'file': (file_path, open(file_path, 'rb'))}
    response = requests.post(url, files=files, params=params)
    if response.status_code == 200:
        json_response = response.json()
        resource = json_response['resource']
        print(f"File submitted for scanning. Resource ID: {resource}")
        check_report(resource, api_key)
    else:
        print("File submission failed.")

def check_report(resource, api_key):
    url = 'https://www.virustotal.com/vtapi/v2/file/report'
    params = {'apikey': api_key, 'resource': resource}
    response = requests.get(url, params=params)
    if response.status_code == 200:
        json_response = response.json()
        response_code = json_response['response_code']
        if response_code == 1:
            positives = json_response['positives']
            total = json_response['total']
            if positives > 0:
                print(f"The file is malicious. Detected by {positives}/{total} antivirus engines.")
            else:
                print("The file is clean. It is not detected by any antivirus engines.")
        elif response_code == -2:
            print("The file is still being analyzed. Please check again later.")
        else:
            print("File scan failed. The file may not have been scanned or does not exist in VirusTotal.")
    else:
        print("Failed to retrieve the scan report.")

# Example usage
file_to_check = 'Replace/path/to/file'  # Replace with the path to your new file
api_key = 'replace with API key'  # Replace with your VirusTotal API key

check_file(file_to_check, api_key)
